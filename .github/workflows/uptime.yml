name: Website Uptime Monitor

on:
  schedule:
    - cron: "*/5 * * * *"   # har 5 minute me chalega
  workflow_dispatch:        # manually run karne ka option bhi

jobs:
  check-website:
    runs-on: ubuntu-latest

    steps:
    - name: Check Website Status and Notify Slack
      run: |
        SITE_URL="https://cinepolis.com/in"

        # Browser jaisa User-Agent use karo, taaki bot block na ho
        STATUS=$(curl -s -o /dev/null -w "%{http_code}" \
          --user-agent "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36" \
          -H "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8" \
          --max-time 15 \
          "$SITE_URL")

        if [ "$STATUS" = "000" ] || [ "$STATUS" -lt 200 ] || [ "$STATUS" -ge 300 ]; then
          MESSAGE="ðŸš¨ *Website DOWN*
URL: $SITE_URL
Status: HTTP $STATUS"
        else
          MESSAGE="âœ… *Website UP*
URL: $SITE_URL
Status: HTTP $STATUS"
        fi

        curl -X POST -H 'Content-type: application/json' \
          --data "{\"text\":\"$MESSAGE\"}" \
          "${{ secrets.SLACK_WEBHOOK_URL }}"
